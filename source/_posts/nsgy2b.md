---
title: 35、Git
urlname: nsgy2b
date: '2021-07-09 20:47:33 +0800'
tags: []
categories: []
---

**狂神聊 Git**

学习 git 之前，我们需要先明白一个概念，版本控制！

# 版本控制

什么是版本控制
版本控制（Revision control）是一种在开发的过程中用于管理我们对文件、目录或工程等内容的修改历史，方便查看更改历史记录，备份以便恢复以前的版本的软件工程技术。
实现跨区域多人协同开发
追踪和记载一个或者多个文件的历史记录组织和保护你的源代码和文档
统计工作量
并行开发、提高开发效率
跟踪记录整个软件的开发过程
减轻开发人员的负担，节省时间，同时降低人为错误
简单说就是用于管理多人协同开发项目的技术。
没有进行版本控制或者版本控制本身缺乏正确的流程管理，在软件开发过程中将会引入很多问题，如软 件代码的一致性、软件内容的冗余、软件过程的事物性、软件开发过程中的并发性、软件源代码的安全 性，以及软件的整合等问题。
![](https://cdn.nlark.com/yuque/0/2021/jpeg/21990331/1625834855724-555a779f-1a41-451e-9011-e821efff864b.jpeg#)

常见的版本控制工具
主流的版本控制器有如下这些：
**Git SVN**（Subversion）
**CVS**（Concurrent Versions System）
**VSS**（Micorosoft Visual SourceSafe） **TFS**（Team Foundation Server） Visual Studio Online
版本控制产品非常的多（Perforce、Rational ClearCase、RCS（GNU Revision Control System）、Serena Dimention、SVK、BitKeeper、Monotone、Bazaar、Mercurial、SourceGear Vault），现在影响力最大且使用最广泛的是 Git 与 SVN

版本控制分类

## 1、本地版本控制

记录文件每次的更新，可以对每个版本做一个快照，或是记录补丁文件，适合个人用，如 RCS。

![](https://cdn.nlark.com/yuque/0/2021/png/21990331/1625834856199-7da233f9-29eb-4f25-ad41-8c48acdbecaf.png#)

## 2、集中版本控制

所有的版本数据都保存在服务器上，协同开发者从服务器上同步更新或上传自己的修改
![](https://cdn.nlark.com/yuque/0/2021/jpeg/21990331/1625834856740-49cc8790-5921-4149-b477-b9a6a10203da.jpeg#)
所有的版本数据都存在服务器上，用户的本地只有自己以前所同步的版本，如果不连网的话，用户就看 不到历史版本，也无法切换版本验证问题，或在不同分支工作。而且，所有数据都保存在单一的服务器 上，有很大的风险这个服务器会损坏，这样就会丢失所有的数据，当然可以定期备份。代表产品：
SVN、CVS、VSS

## 3、分布式版本控制

所有版本信息仓库全部同步到本地的每个用户，这样就可以在本地查看所有版本历史，可以离线在本地 提交，只需在连网时 push 到相应的服务器或其他用户那里。由于每个用户那里保存的都是所有的版本数 据，只要有一个用户的设备没有问题就可以恢复所有的数据，但这增加了本地存储空间的占用。
![](https://cdn.nlark.com/yuque/0/2021/jpeg/21990331/1625834857204-b08eabaf-2064-4d70-9e93-5b292ad751df.jpeg#)

Git 与 SVN 最主要区别
SVN 是集中式版本控制系统，版本库是集中放在中央服务器的，而工作的时候，用的都是自己的电脑， 所以首先要从中央服务器得到最新的版本，然后工作，完成工作后，需要把自己做完的活推送到中央服 务器。集中式版本控制系统是必须联网才能工作，对网络带宽要求较高。
![](https://cdn.nlark.com/yuque/0/2021/jpeg/21990331/1625834857688-5749c977-fd8a-4df3-94fb-2376a184aba0.jpeg#)
Git 是分布式版本控制系统，没有中央服务器，每个人的电脑就是一个完整的版本库，工作的时候不需要 联网了，因为版本都在自己电脑上。协同的方法是这样的：比如说自己在电脑上改了文件 A，其他人也 在电脑上改了文件 A，这时，你们两之间只需把各自的修改推送给对方，就可以互相看到对方的修改
了。
Git 是目前世界上最先进的分布式版本控制系统。

# 聊聊 Git 历史

同生活中的许多伟大事物一样，Git 诞生于一个极富纷争大举创新的年代。

Linux 内核开源项目有着为数众广的参与者。 绝大多数的 Linux 内核维护工作都花在了提交补丁和保存归档的繁琐事务上(1991－2002 年间)。 到 2002 年，整个项目组开始启用一个专有的分布式版本控制系统 BitKeeper 来管理和维护代码。
到了 2005 年，开发 BitKeeper 的商业公司同 Linux 内核开源社区的合作关系结束，他们收回了 Linux
内核社区免费使用 BitKeeper 的权力。 这就迫使 Linux 开源社区(特别是 Linux 的缔造者 Linus
Torvalds)基于使用 BitKeeper 时的经验教训，开发出自己的版本系统。 也就是后来的 Git！
Git 是目前世界上最先进的分布式版本控制系统。
Git 是免费、开源的，最初 Git 是为辅助 Linux 内核开发的，来替代 BitKeeper！
![](https://cdn.nlark.com/yuque/0/2021/jpeg/21990331/1625834858237-bbe66a1b-a1c6-4767-81e3-d9e24991d847.jpeg#)
Linux 和 Git 之父李纳斯·托沃兹（Linus Benedic Torvalds）1969、芬兰

# Git 环境配置

软件下载
打开 [git 官网] [https://git-scm.com/](https://git-scm.com/)，下载 git 对应操作系统的版本。
官网下载太慢，我们可以使用淘宝镜像下载：[http://npm.taobao.org/mirrors/git-for-windows/](http://npm.taobao.org/mirrors/git-for-windows/)
![](https://cdn.nlark.com/yuque/0/2021/jpeg/21990331/1625834858945-5efaf1cc-604c-4401-8fc9-7065ccf9ce8d.jpeg#)

下载对应的版本即可安装！ 安装：无脑下一步即可！

启动 Git
安装成功后在开始菜单中会有 Git 项，菜单下有 3 个程序：
![](https://cdn.nlark.com/yuque/0/2021/png/21990331/1625834859251-7d3eacbb-5af9-4487-a9be-ac10a22ebe24.png#)
**Git Bash：**Unix 与 Linux 风格的命令行，使用最多，推荐最多**Git CMD：**Windows 风格的命令行
**Git GUI**：图形界面的 Git，不建议初学者使用，尽量先熟悉常用命令

基本的 Linux 命令学习

1. 、cd : 改变目录。
1. 、cd . . 回退到上一个目录，直接 cd 进入默认目录
1. 、pwd : 显示当前所在的目录路径。
1. 、ls(ll): 都是列出当前目录中的所有文件，只不过 ll(两个 ll)列出的内容更为详细。
1. 、touch : 新建一个文件 如 touch index.js 就会在当前目录下新建一个 index.js 文件。
1. 、rm: 删除一个文件, rm index.js 就会把 index.js 文件删除。
1. 、mkdir: 新建一个目录,就是新建一个文件夹。
1. 、rm -r : 删除一个文件夹, rm -r src 删除 src 目录
1. 、mv 移动文件, mv index.html src index.html 是我们要移动的文件, src 是目标文件夹,当然, 这样写, 必须保证文件和目标文件夹在同一目录下。
1. 、reset 重新初始化终端/清屏。
1. 、clear 清屏。
1. 、history 查看命令历史。
1. 、help 帮助。
1. 、exit 退出。
1. 、#表示注释

git config -l

Git 配置
查看配置

![](https://cdn.nlark.com/yuque/0/2021/png/21990331/1625834859792-98d188a9-c7dd-43c2-897a-de564048809b.png#)

查看不同级别的配置文件：

| 1   | #查看系统 config            |
| --- | --------------------------- |
| 2   | git config --system --list  |
| 3   |                             |
| 4   | #查看当前用户（global）配置 |
| 5   | git config --global --list  |

## Git 相关的配置文件：

1. 、Git\mingw64\etc\gitconﬁg ： Git 安装目录下的 gitconﬁg --system 系统级 2）、C:\Users\Administrator\ .gitconﬁg 只适用于当前登录用户的配置 --global 全局这里可以直接编辑配置文件，通过命令设置后会响应到这里。

设置用户名与邮箱（用户标识，必要）
当你安装 Git 后首先要做的事情是设置你的用户名称和 e-mail 地址。这是非常重要的，因为每次 Git 提交都会使用该信息。它被永远的嵌入到了你的提交中：

| 1   | git | config | --global | user.name "kuangshen" #名称                          |       |
| --- | --- | ------ | -------- | ---------------------------------------------------- | ----- |
| 2   | git | config | --global | user.email [24736743@qq.com](mailto:24736743@qq.com) | #邮箱 |

只需要做一次这个设置，如果你传递了--global 选项，因为 Git 将总是会使用该信息来处理你在系统中所做的一切操作。如果你希望在一个特定的项目中使用不同的名称或 e-mail 地址，你可以在该项目中运行该命令而不要--global 选项。 总之--global 为全局配置，不加为某个项目的特定配置。

# Git 基本理论

工作区域

Git 本地有三个工作区域：工作目录（Working Directory）、暂存区(Stage/Index)、资源库(Repository 或 Git Directory)。如果在加上远程的 git 仓库(Remote Directory)就可以分为四个工作区域。文件在这四个区域之间的转换关系如下：
![](https://cdn.nlark.com/yuque/0/2021/jpeg/21990331/1625834860327-69d07091-e4f0-4df8-a110-152bd0ac1c02.jpeg#)
Workspace：工作区，就是你平时存放项目代码的地方
Index / Stage：暂存区，用于临时存放你的改动，事实上它只是一个文件，保存即将提交到文件列表 信 息 Repository：仓库区（或本地仓库），就是安全存放数据的位置，这里面有你提交到所有版本的数据 。 其 中 HEAD 指 向 最 新 放 入 仓 库 的 版 本 Remote：远程仓库，托管代码的服务器，可以简单的认为是你项目组中的一台电脑用于远程数据交换
本地的三个区域确切的说应该是 git 仓库中 HEAD 指向的版本：
![](https://cdn.nlark.com/yuque/0/2021/png/21990331/1625834860942-1b54f8f3-2873-4ef2-a358-9540dd9cc71b.png#)
Directory：使用 Git 管理的一个目录，也就是一个仓库，包含我们的工作空间和 Git 的管理空间。
WorkSpace：需要通过 Git 进行版本控制的目录和文件，这些目录和文件组成了工作空间。
.git：存放 Git 管理信息的目录，初始化仓库的时候自动创建。

Index/Stage：暂存区，或者叫待提交更新区，在提交进入 repo 之前，我们可以把所有的更新放在 暂存区。
Local Repo：本地仓库，一个存放在本地的版本库；HEAD 会只是当前的开发分支（branch）。
Stash：隐藏，是一个工作状态保存栈，用于保存/恢复 WorkSpace 中的临时状态。

工作流程
git 的工作流程一般是这样的： １、在工作目录中添加、修改文件；
２、将需要进行版本管理的文件放入暂存区域；
３、将暂存区域的文件提交到 git 仓库。
因此，git 管理的文件有三种状态：已修改（modiﬁed）,已暂存（staged）,已提交(committed)
![](https://cdn.nlark.com/yuque/0/2021/png/21990331/1625834861525-0a2dd287-af14-4ae3-b6ac-bbc35243b01c.png#)

# Git 项目搭建

创建工作目录与常用指令
工作目录（WorkSpace)一般就是你希望 Git 帮助你管理的文件夹，可以是你项目的目录，也可以是一个 空目录，建议不要有中文。
日常使用只要记住下图 6 个命令：

![](https://cdn.nlark.com/yuque/0/2021/png/21990331/1625834861922-1ad637bf-97e5-4d9a-baca-d09cba84d454.png#)

本地仓库搭建
创建本地仓库的方法有两种：一种是创建全新的仓库，另一种是克隆远程仓库。
1、创建全新的仓库，需要用 GIT 管理的项目的根目录执行：

1. # 在当前目录新建一个 Git 代码库
1. $ git init

2、执行后可以看到，仅仅在项目目录多出了一个.git 目录，关于版本等的所有信息都在这个目录里面。

克隆远程仓库
1、另一种方式是克隆远程目录，由于是将远程服务器上的仓库完全镜像一份至本地！

1. # 克隆一个项目和它的整个代码历史(版本信息)
1. $ git clone [url]

2、去 gitee 或者 github 上克隆一个测试！

# GIT 文件操作

文件 4 种状态
版本控制就是对文件的版本控制，要对文件进行修改、提交等操作，首先要知道文件当前在什么状态， 不然可能会提交了现在还不想提交的文件，或者要提交的文件没提交上。
**Untracked**: 未跟踪, 此文件在文件夹中, 但并没有加入到 git 库, 不参与版本控制. 通过
git add
状态变为 .
Staged
**Unmodify**: 文件已经入库, 未修改, 即版本库中的文件快照内容与文件夹中完全一致. 这种类型的文
Modified

件有两种去处, 如果它被修改, 而变为
文件
Untracked
. 如果使用 git rm 移出版本库, 则成为
**Modiﬁed**: 文件已修改, 仅仅是修改, 并没有进行其他的操作. 这个文件也有两个去处, 通过 git

add 可进入暂存 staged 状态, 使用
git checkout
这个 git checkout 即从库中取出文件, 覆盖当前修改 !
则丢弃修改过, 返回到 unmodify 状态,
**Staged**: 暂存状态. 执行 git commit 则将修改同步到库中, 这时库中的文件和本地文件又变为一致, 文件为 Unmodify 状态. 执行 git reset HEAD filename 取消暂存, 文件状态为
Modified

查看文件状态
上面说文件有 4 种状态，通过如下命令可以查看到文件的状态：

| 1   | #查看指定文件状态     |
| --- | --------------------- |
| 2   | git status [filename] |
| 3   |                       |
| 4   | #查看所有文件状态     |
| 5   | git status            |

忽略文件
有些时候我们不想把某些文件纳入版本控制中，比如数据库文件，临时文件，设计文件等 在主目录下建立".gitignore"文件，此文件有如下规则：

1.  忽略文件中的空行或以井号（#）开始的行将会被忽略。
1.  可以使用 Linux 通配符。例如：星号（\*）代表任意多个字符，问号（？）代表一个字符，方括号

（[abc]）代表可选字符范围，大括号（{string1,string2,...}）代表可选的字符串等。

1.  如果名称的最前面有一个感叹号（!），表示例外规则，将不被忽略。
1.  如果名称的最前面是一个路径分隔符（/），表示要忽略的文件在此目录下，而子目录中的文件不 忽略。
1.  如果名称的最后面是一个路径分隔符（/），表示要忽略的是此目录下该名称的子目录，而非文件

（默认文件或目录都忽略）。

| 1   | #为注释    |                                                     |
| --- | ---------- | --------------------------------------------------- |
| 2   | \*.txt     | #忽略所有 .txt 结尾的文件                           |
| 3   | !lib.txt   | #但 lib.txt 除外                                    |
| 4   | /temp      | #仅忽略项目根目录下的 TODO 文件,不包括其它目录 temp |
| 5   | build/     | #忽略 build/目录下的所有文件                        |
| 6   | doc/\*.txt | #会忽略 doc/notes.txt 但不包括 doc/server/arch.txt  |

# 使用码云

1、注册登录码云，完善个人信息
2、设置本机绑定 SSH 公钥，实现免密码登录！

| 1   | # 进入 C:\Users\Administrator\.ssh | 目录 |
| --- | ---------------------------------- | ---- |
| 2   | # 生成公钥                         |      |
| 3   | ssh-keygen -t rsa                  |      |

3、将公钥信息 public key 添加到码云账户中即可！
4、使用码云创建一个自己的仓库！

# IDEA 中集成 Git

1、新建项目，绑定 git。
2、修改文件，使用 IDEA 操作 git。
3、提交测试

# 说明：GIT 分支

分支在 GIT 中相对较难，分支就是科幻电影里面的平行宇宙，如果两个平行宇宙互不干扰，那对现在的你也没啥影响。不过，在某个时间点，两个平行宇宙合并了，我们就需要处理一些问题了！
![](https://cdn.nlark.com/yuque/0/2021/png/21990331/1625834862281-ef885dac-79b8-4548-9888-809425d01e5b.png#)
git 分支中常用指令：

| 1   | # 列出所有本地分支                       |
| --- | ---------------------------------------- |
| 2   | git branch                               |
| 3   |                                          |
| 4   | # 列出所有远程分支                       |
| 5   | git branch -r                            |
| 6   |                                          |
| 7   | # 新建一个分支，但依然停留在当前分支     |
| 8   | git branch [branch-name]                 |
| 9   |                                          |
| 10  | # 新建一个分支，并切换到该分支           |
| 11  | git checkout -b [branch]                 |
| 12  |                                          |
| 13  | # 合并指定分支到当前分支                 |
| 14  | $ git merge [branch]                     |
| 15  |                                          |
| 16  | # 删除分支                               |
| 17  | $ git branch -d [branch-name]            |
| 18  |                                          |
| 19  | # 删除远程分支                           |
| 20  | $ git push origin --delete [branch-name] |
| 21  | $ git branch -dr [remote/branch]         |

如果同一个文件在合并分支时都被修改了则会引起冲突：解决的办法是我们可以修改冲突文件后重新提 交！
master 主分支应该非常稳定，用来发布新版本，一般情况下不允许在上面工作，工作一般情况下在新建的 dev 分支上工作，工作完后，比如上要发布，或者说 dev 分支代码稳定后可以合并到主分支 master 上来。
